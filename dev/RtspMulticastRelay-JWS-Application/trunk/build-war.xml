<?eclipse.ant.import?>
<project>

	<import file="build-jar.xml" />
    <import file="build-jnlp.xml" />
	
	<property name="war.file" value="${app.name}.war" />

    <target name="copy-jars" description="copies external jars required by application">
        <copy file="${jars-jain-sdp.location}/ext/jain-sdp-1.0.100.jar" toDir="WebContent"/>
    </target>
    
    <target name="sign-jars" description="signs jar files for deployment" depends="build-jar,copy-jars">
        <input message="Please enter keystore file path:" addproperty="keystore" defaultvalue="keystore" />
        <input message="Please enter keystore password:" addproperty="keypass" defaultvalue="testpass" />
        <input message="Please enter key name:" addproperty="alias" defaultvalue="testkey" />
        <signjar keystore="${keystore}" storepass="${keypass}" alias="${alias}">
            <fileset dir="WebContent" includes="*.jar" />
        </signjar>
    </target>

	<target name="build-war" depends="build-jnlp, sign-jars">
	    <war destfile="build/${war.file}" webxml="WebContent/WEB-INF/web.xml">
	    	<fileset dir="WebContent">
	    		<exclude name="WEB-INF/web.xml"/>
	    	</fileset>
	        <lib dir="WebContent/WEB-INF/lib"/>
	    </war>
	</target>
	
	<target name="clean-war">
		<delete file="build/${war.file}" />
	</target>
	
</project>
