<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Service Launcher Applet</title>
<script src="http://java.com/js/deployJava.js" language="JavaScript" type="text/javascript"></script>
<script src="./deployLauncher.js" language="JavaScript" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">

window.onerror = function(errorMessage, fileName, lineNumber) {
	alert("error: "+errorMessage);
	return true;
}

var params = {};
var isIE = navigator.userAgent.indexOf('MSIE') !=-1;
var appletId = "launcher";
var servicePort = "9999";

function confirmRestart() {
    if (confirm("The service has terminated.\nDo you wish to restart it?")) {
        var applet = document.getElementById(appletId);
        applet.start();
    }
}

function confirmRetry() {
    var applet = document.getElementById(appletId);
    while (confirm("Service launcher applet failed to connect to service.\nDo you wish to retry?")
            && !applet.start()) {}
}

function confirmReconnect() {
    var applet = document.getElementById(appletId);
    while (confirm("Service launcher applet was disconnected from service.\nDo you wish to attempt to reconnect to the service?")
            && !applet.start()) {}
}

function constructApplet() {

    var parameters = {
            ServiceJnlpUrl:"ServiceLauncherApplet.jnlp",
            ServicePort:servicePort,
            UseKeepAlive:true,
            ConnectionRetryCount:10,
            ConnectionRetryInterval:1000,
            OnTerminationUrl:"javascript:confirmRestart()",
            OnErrorUrl:"javascript:confirmRetry()",
            OnDisconnectUrl:"javascript:confirmReconnect()",
    }

    deployLauncher(appletId,parameters);

}

function showAppletInfo() {
    var applet = document.getElementById(appletId);
    if (applet != null) {
        var appletInfo = applet.getAppletInfo();
        document.getElementById("info").innerHTML = appletInfo;
        var parameterInfoArray = applet.getParameterInfo();
        var tbody = document.getElementById("parameters");
        for (var pindex = 0; pindex < parameterInfoArray.length; pindex++) {
            var row = document.createElement("tr");
            var parameterInfo = parameterInfoArray[pindex];
            var parameterName = parameterInfo[0];
            var col = document.createElement("td");
            row.appendChild(col);
            col.appendChild(document.createTextNode(parameterName));
            var parameterType = parameterInfo[1];
            var col = document.createElement("td");
            col.appendChild(document.createTextNode(parameterType));
            row.appendChild(col);
            var parameterDescription = parameterInfo[2];
            var col = document.createElement("td");
            col.appendChild(document.createTextNode(parameterDescription));
            row.appendChild(col);
            tbody.appendChild(row);
        }
    }
}

</script>
</head>
<body onload="constructApplet()" style="font-size:11pt">
    <p id="info"></p>
    <p>Applet Properties:</p>
    <table border="1" cellpadding="5">
    <thead style="background-color:#CCCCCC">
    <tr><td>Name</td><td>Type</td><td>Description</td></tr>
    </thead>
    <tbody id="parameters"></tbody>
    </table>
    <script language="JavaScript" type="text/javascript">
        constructApplet();
    </script>
    <p>
    View the source for this page to see usage.
    <p>
    The following code demonstrates the use of the deployLauncher() function contained in deployLauncher.js.
    The deployLauncher.js code requires functions contained in deployJava.js, so both must be included.
    <pre style="font-family:courier;font-size:10pt;color:#006600">
&lt;html&gt;
  &lt;head&gt;
    ...
    &lt;script src="http://java.com/js/deployJava.js" language="JavaScript" type="text/javascript"&gt;&lt;/script&gt;
    &lt;script src="./deployLauncher.js" language="JavaScript" type="text/javascript"&gt;&lt;/script&gt;
    &lt;script language="JavaScript" type="text/javascript"&gt;

      function constructApplet() {

          var parameters = {
              ServiceJnlpUrl : "MyService.jnlp",
              ServicePort : 9999,
              UseKeepAlive : true,
              ConnectionRetryCount : 10,
              ConnectionRetryInterval : 1000,
              OnConnectUrl : "javascript:onConnect()",
              OnDisconnectUrl : "javascript:onDisconnect()",
              OnTerminationUrl : "javascript:onTermination()",
              OnErrorUrl : "javascript:onError()",
          }

          deployLauncher("launcher", parameters);

      }

      function onConnect() {...}
      function onDisconnect() {...}
      function onTermination() {...}
      function onError() {...}

    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    ...
  &lt;/body&gt;
&lt;/html&gt;
    </pre>
</body>
</html>
